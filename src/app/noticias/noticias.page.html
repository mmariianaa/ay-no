<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button routerLink="/home" routerDirection="root">
        <ion-icon slot="start" name="arrow-back"></ion-icon>
        Regresar
      </ion-button>
    </ion-buttons>
    
    <ion-title>
      <div class="header-title">
        <ion-icon name="newspaper-outline"></ion-icon>
        <span>Noticias de Desapariciones</span>
      </div>
    </ion-title>
    
    <ion-buttons slot="end">
      <ion-button (click)="cargarNoticias()" fill="clear">
        <ion-icon slot="icon-only" name="refresh"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Filtros/Info -->
  <ion-card color="light" class="info-card">
    <ion-card-content>
      <div class="filter-info">
        <div>
          <ion-icon name="filter-outline"></ion-icon>
          <strong>Filtro:</strong> Desapariciones en México
        </div>
        <div>
          <ion-icon name="calendar-outline"></ion-icon>
          <strong>Orden:</strong> Más recientes primero
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Estado de carga -->
  @if (cargando) {
    <div class="loading-container">
      <ion-spinner name="crescent" color="primary"></ion-spinner>
      <p class="loading-text">Buscando noticias de desapariciones...</p>
    </div>
  }

  <!-- Error -->
  @if (error && !cargando) {
    <div class="error-container">
      <ion-icon name="warning-outline" color="danger" size="large"></ion-icon>
      <h3>¡Ups! Algo salió mal</h3>
      <p>{{ error }}</p>
      <ion-button (click)="cargarNoticias()" color="primary" fill="solid">
        <ion-icon slot="start" name="refresh"></ion-icon>
        Reintentar
      </ion-button>
    </div>
  }

  <!-- Grid de noticias (3 por fila) -->
  @if (!cargando && !error && noticias.length > 0) {
    <div class="noticias-grid">
      @for (noticia of noticias; track noticia.url; let i = $index) {
        <ion-card class="noticia-card" (click)="verDetalle(noticia)">
          <!-- Badge con número -->
          <div class="card-badge">
            <span class="badge-number">#{{ i + 1 }}</span>
          </div>
          
          <!-- Imagen de la noticia -->
          @if (noticia.urlToImage) {
            <div class="card-image-container">
              <img [src]="noticia.urlToImage" [alt]="noticia.title" class="card-image" />
              <div class="image-overlay"></div>
            </div>
          } @else {
            <div class="card-image-placeholder">
              <ion-icon name="image-outline" size="large"></ion-icon>
              <p>Sin imagen</p>
            </div>
          }
          
          <ion-card-header>
            <ion-card-title class="card-title">
              {{ noticia.title | slice:0:80 }}{{ noticia.title.length > 80 ? '...' : '' }}
            </ion-card-title>
          </ion-card-header>
          
          <ion-card-content>
            <!-- Descripción -->
            <p class="card-description">
              {{ noticia.description | slice:0:120 }}{{ noticia.description.length > 120 ? '...' : '' }}
            </p>
            
            <!-- Información adicional -->
            <div class="card-footer">
              <div class="source-info">
                <ion-icon name="business-outline" size="small"></ion-icon>
                <span class="source-name">{{ noticia.source?.name || 'Fuente desconocida' }}</span>
              </div>
              
              <div class="date-info">
                <ion-icon name="calendar-outline" size="small"></ion-icon>
                <span class="date-text">{{ noticia.publishedAt | date:'dd/MM/yyyy' }}</span>
              </div>
            </div>
            
            <!-- Botón para ver más -->
            <ion-button expand="block" color="medium" fill="clear" size="small" class="ver-mas-btn">
              <ion-icon slot="start" name="open-outline"></ion-icon>
              Ver noticia completa
            </ion-button>
          </ion-card-content>
        </ion-card>
      }
    </div>
  }
</ion-content>
